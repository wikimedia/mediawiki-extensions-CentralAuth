{
  "comments": [
    {
      "key": {
        "uuid": "53379642_6ea253d9",
        "filename": "includes/CentralAuthUser.php",
        "patchSetId": 2
      },
      "lineNbr": 2886,
      "author": {
        "id": 1453
      },
      "writtenOn": "2019-03-13T13:31:04Z",
      "side": 1,
      "message": "This appears to make sense. The table does not contain one index with two fields, but two indexes with one field each. According to the documentation of replace() this must be provided as an \"array of lists\".\n\nHm. Wait. Doesn\u0027t this mean it must be written like this?\n\n [ [ \u0027gug_user\u0027 ], [ \u0027gug_group\u0027 ] ]",
      "range": {
        "startLine": 2886,
        "startChar": 3,
        "endLine": 2886,
        "endChar": 34
      },
      "revId": "d7e77bf0cee78bc127a7a4176fbdfb5adbca0a7d",
      "serverId": "e9e9afe9-4712-486d-8885-f54b72dd1951",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9895e3d0_dfff76a0",
        "filename": "includes/CentralAuthUser.php",
        "patchSetId": 2
      },
      "lineNbr": 2886,
      "author": {
        "id": 16
      },
      "writtenOn": "2019-03-13T14:45:12Z",
      "side": 1,
      "message": "That means the same as the current code, e.g. \"each of those field are separately unique fields\". The unique index is a composite one, so it has to be an array of arrays.\n\nI made https://gerrit.wikimedia.org/r/#/c/mediawiki/core/+/496096/ after fixing a bunch of incorrect uses. The current IDatabase documentation is ambiguous (e.g. \"fields [each] defining a unique index\" or \"fields [together] defining a unique index\"?). What it actually does is the first one.",
      "parentUuid": "53379642_6ea253d9",
      "range": {
        "startLine": 2886,
        "startChar": 3,
        "endLine": 2886,
        "endChar": 34
      },
      "revId": "d7e77bf0cee78bc127a7a4176fbdfb5adbca0a7d",
      "serverId": "e9e9afe9-4712-486d-8885-f54b72dd1951",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "ef332124_136ab42c",
        "filename": "includes/CentralAuthUser.php",
        "patchSetId": 2
      },
      "lineNbr": 2886,
      "author": {
        "id": 1453
      },
      "writtenOn": "2019-03-13T15:33:07Z",
      "side": 1,
      "message": "I might miss something here, but when I look at the code in the CentralAuth extension, it does not contain a composite index:\n\n CREATE INDEX /*i*/gug_user ON /*_*/global_user_groups (gug_user);\n CREATE INDEX /*i*/gug_group ON /*_*/global_user_groups (gug_group);\n\n CREATE INDEX /*i*/ggp_group ON /*_*/global_group_permissions (ggp_group);\n CREATE INDEX /*i*/ggp_permission ON /*_*/global_group_permissions (ggp_permission);\n\nSo what you say is certainly all correct and fine. It\u0027s just that it seems it does not apply on this particular extension.",
      "parentUuid": "9895e3d0_dfff76a0",
      "range": {
        "startLine": 2886,
        "startChar": 3,
        "endLine": 2886,
        "endChar": 34
      },
      "revId": "d7e77bf0cee78bc127a7a4176fbdfb5adbca0a7d",
      "serverId": "e9e9afe9-4712-486d-8885-f54b72dd1951",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "dd8ed620_662637c3",
        "filename": "includes/CentralAuthUser.php",
        "patchSetId": 2
      },
      "lineNbr": 2886,
      "author": {
        "id": 16
      },
      "writtenOn": "2019-03-13T18:54:14Z",
      "side": 1,
      "message": "It\u0027s the PRIMARY KEY index, not a secondary unique index.",
      "parentUuid": "ef332124_136ab42c",
      "range": {
        "startLine": 2886,
        "startChar": 3,
        "endLine": 2886,
        "endChar": 34
      },
      "revId": "d7e77bf0cee78bc127a7a4176fbdfb5adbca0a7d",
      "serverId": "e9e9afe9-4712-486d-8885-f54b72dd1951",
      "unresolved": false
    }
  ]
}